<div class="content">
	<h1>ProduktBatch-Liste</h1>
	<table class="user-table">
		<thead>
			<tr>
				<th>ProduktBatchID</th>
				<th>ProduktBatch-Navn</th>
				<th></th>
			</tr>
		</thead>
		<tbody></tbody>
	</table>
	<a href="javascript:;" id="createProductBatch">Opret ProduktBatch</a>
	<a href="startpage.html" id="homeBtn">Tilbage</a>
</div>

<script type="text/javascript" src="assets/js/main.js"></script>

<!-- Fix så man kan oprette receptkomponenter fra listen, og link opret-knappn så den loader createReceptComponent.html. (Opret i ReceptService? aka spørg Michael) -->
<script>
$.ajax({
	type: 'GET',
	url: 'http://localhost:8080/CDIO-D3-s2/rest/Product/getProductBatchList',
	dataType: 'json',
	success: function(data){
		if(data.response_status == "success"){
			response = JSON.parse(data.response_message);
			for(var i = 0; i < response.length; i++){
				$(".user-table tbody").append('<tr id="' + response[i].productBatchID + '"><td>' + response[i].status + '</td><td>' + response[i].receptID + '</td><td><select id="options"><option value="vælg">-Vælg-</option><option value="deleteProductBatch">Slet ProduktBatch</option><option value="updateProductBatch">Opdater ProduktBatch</option><option value="showProductBatchComponent">Vis PBCK</option></select></td></tr>');
			}
			
			$('.user-table').on('change', 'tr select', function(){
				
				var receptID = $(this).closest("tr").attr("id");
				
				if (this.value == "showProductBatchComponent"){
					$(".content-container").load('ProductBatchComponentList.html');
					$.ajax({
						type: 'GET',
						url: 'http://localhost:8080/CDIO-D3-s2/rest/Product/getProductBatch',
						dataType: 'json',
						data: {
							productBatchID: productBatchID
						},
						success: function(data){
							if(data.response_status == "success"){
								var response = JSON.parse(data.response_message);
								$("input[name=productBatchID]").val(response.productBatchID);
								$("input[name=status]").val(response.status);
								$("input[name=receptID]").val(response.receptID);
							} else {
								showStatusMessage(data.response_code + ": " + data.response_message, data.response_status);
							}
						}
					});
				}
			});
		} else {
			showStatusMessage(data.response_code + ": " + data.response_message, data.response_status);
		}
	}
});
</script>